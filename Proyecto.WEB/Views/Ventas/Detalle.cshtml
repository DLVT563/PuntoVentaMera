@model Proyecto.WEB.Models.ViewModels.VentaViewModel

@{
    ViewData["Title"] = $"Detalle Venta #{Model.IdVenta}";
}

<h2>Detalle de Venta #@Model.IdVenta</h2>

<div class="mb-3">
    <strong>Fecha:</strong> @Model.Fecha.ToString("dd/MM/yyyy HH:mm") <br />
    <strong>Cliente:</strong> @(Model.IdCliente) <br />
    <strong>Total:</strong> @Model.Total.ToString("C") <br />
    <strong>Pagado:</strong> @(Model.Pagado ? "Sí" : "No") <br />
    <strong>Fiado:</strong> @(Model.EsFiado ? "Sí" : "No") <br />
    <strong>Anulado:</strong> @(Model.Anulado ? "Sí" : "No") <br />
    <strong>Observaciones:</strong> @Model.Observaciones <br />
    <strong>Tipo de comprobante:</strong> @Model.TipoComprobante <br />
    <strong>Serie:</strong> @Model.Serie <br />
    <strong>Número Documento:</strong> @Model.NumeroDocumento <br />
    <strong>Método de pago:</strong> @Model.MetodoPago <br />
    <strong>Fecha estimada de pago:</strong> @(Model.FechaPagoEstimada.HasValue? Model.FechaPagoEstimada.Value.ToString("dd/MM/yyyy") : "N/A")
</div>

<h3>Productos de la Venta</h3>
<table class="table table-bordered table-hover">
    <thead class="table-dark">
        <tr>
            <th>Producto</th>
            <th>Cantidad</th>
            <th>Precio Unitario</th>
            <th>Subtotal</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var detalle in Model.DetalleVenta)
        {
            <tr>
                <td>@detalle.NombreProducto</td>
                <td>@detalle.Cantidad</td>
                <td>@detalle.PrecioUnitario.ToString("C")</td>
                <td>@detalle.Subtotal.ToString("C")</td>
            </tr>
        }
    </tbody>
</table>

@if (Model.HistorialStock != null && Model.HistorialStock.Any())
{
    <h3>Historial de Stock</h3>
    <table class="table table-bordered table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>Producto</th>
                <th>Tipo</th>
                <th>Cantidad</th>
                <th>Fecha</th>
                <th>Referencia</th>
                <th>Motivo</th>
                <th>Usuario</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var mov in Model.HistorialStock)
            {
                <tr>
                    <td>@mov.NombreProducto</td>
                    <td>@mov.Tipo</td>
                    <td>@mov.Cantidad</td>
                    <td>@mov.Fecha.ToString("dd/MM/yyyy HH:mm")</td>
                    <td>@mov.Referencia</td>
                    <td>@mov.Motivo</td>
                    <td>@mov.NombreUsuario</td>
                </tr>
            }
        </tbody>
    </table>
}
